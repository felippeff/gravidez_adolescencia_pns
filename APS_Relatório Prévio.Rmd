---
title: "**Diferenças sociodemográficas, econômicas e comportamentais entre mães adolescentes (<18 anos) e mães adultas (≥18 anos) no Brasil, e sua associação com o acesso e utilização de serviços de saúde materno-infantil, segundo a Pesquisa Nacional de Saúde (PNS) 2019 (IBGE, 2020).**"
author: |
  FELIPPE FURTUNATO DE FARIA  
  GABRIEL KATZ  
  JOANA DE JESUS CARVALHO
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 2
    number_sections: true
    theme: cosmo
---

#  Hipótese de Pesquisa

Quanto menor a idade da mãe, menores são os níveis de acesso a serviços de saúde?

#  Motivação para a Escolha do Fenômeno

A gravidez na adolescência é reconhecida como uma importante questão de saúde pública no Brasil e no mundo (WHO, 2018). Mães adolescentes apresentam, em média, menores taxas de escolaridade, maior probabilidade de pertencerem a famílias de baixa renda e dificuldades de acesso a serviços de saúde de qualidade (Vianello; Buchalla, 2002). Essas vulnerabilidades aumentam o risco de desfechos negativos tanto para a mãe quanto para o bebê, como prematuridade, baixo peso ao nascer e morbimortalidade materna e neonatal.

Além disso, o início precoce da vida reprodutiva frequentemente compromete as oportunidades educacionais e profissionais futuras das adolescentes, perpetuando o ciclo de pobreza e desigualdade (Andersen; Aday, 1978). A análise diferenciada entre mães adolescentes e adultas permite identificar lacunas nos serviços de saúde.

#  Base de Dados

A base de dados utilizada é a da Pesquisa Nacional de Saúde (PNS) 2019, realizada pelo IBGE em parceria com o Ministério da Saúde. Trata-se de uma pesquisa de abrangência nacional que coleta informações sobre diversos aspectos da saúde e das condições de vida dos brasileiros (IBGE, 2020).

Para o presente estudo, focamos exclusivamente nas informações pertinentes à comparação entre mães adolescentes e adultas, considerando variáveis relacionadas a características sociodemográficas, condições econômicas, comportamentos em saúde e acesso e utilização de serviços de saúde materno-infantil.

O arcabouço teórico adotado é o Modelo Comportamental de Andersen e Aday, que propõe que o uso de serviços de saúde é determinado por fatores predisponentes, fatores facilitadores e fatores de necessidade (Andersen; Aday, 1978; Andersen, 1995).

#  Principais Objetivos da Análise

Os principais objetivos desta análise são:

1. Comparar características sociodemográficas, econômicas e comportamentais entre mães adolescentes e adultas.
2. Analisar diferenças no acesso e utilização dos serviços de saúde materno-infantil, considerando variáveis como realização de consultas, exames e orientações recebidas.
3. Avaliar a adequação do acompanhamento pré-natal, considerando o número de consultas realizadas, o início precoce do pré-natal e a realização de exames básicos.
4. Investigar fatores associados ao tipo de parto (normal ou cesárea) e ao uso dos serviços públicos de saúde (SUS).
5. Controlar a análise por variáveis sociodemográficas relevantes, como escolaridade, renda domiciliar per capita e área de residência (urbana/rural), conforme o modelo de Andersen (1995).

#  Preparação dos Dados

##  Importação dos Dados

```{r mensagem=FALSE, warning=FALSE}
```


```{r mensagem=FALSE, warning=FALSE}

library(PNSIBGE)
library(PNADcIBGE)
library(geobr)
library(sf)
library(tidyverse)
library(ggplot2)
library(dplyr)


# Importação da PNS 2019 com variáveis selecionadas
install.packages("PNSIBGE")
library(PNSIBGE)
help("get_pns")
pns_2019 <- get_pns(year=2019, vars=c(
# CARACTERÍSTICAS GERAIS
                                      "V0001",  # unidade federativa
                                      "UPA_PNS", # unidade primária de amostragem
                                      "V0006_PNS", # número de ordem do domícilio 
                                      "V0022", # total de moradores 
                                      "V0026", # tipo de situalçao censitária (urbana ou rural)
                                      "B001", # cadastro na unidade de saúde fa família 
                                      "B003", # frequência de visita de agente comunitário ou algum membro da ESF
                                      "C004", # condição no domicílio
                                      "C006", # sexo 
                                      "C008", # idade do morador na data de referência 
                                      "C009", # cor ou raça 
                                      "C01001", # cônjuge ou companheiro mora nesse domicílio
                                      "C014", # qual a natureza da união
                                      "C015", #  esta união é registrada em cartório
                                      "C01801", # idade quando começou a viver com o primeiro / único companheiro
                                      "C00301", # numero de ordem do morador
            
# EDUCAÇÃO
                                      "D001", # sabe ler e escrever
                                      "D00901", # qual foi o curso mais elevado frequentado
# TRABALHO E RENDA (14 anos ou mais)
                                      "E001", # trabalhou ou estágio remunerado na última semana
                                      "E005", # tinha algum trabalho do qual estava afastado
                                      "E006011", # motivo de afastamento do trabalho
                                      "E01602", # rendimento bruto
                                      "E017", # quantas horas efetivamente trabalhou na semana
                                      "E03101", # fez tarefas domésticas: alimento, arrumar mesa, lavar louça
                                      "E03102", # fez tarefas domésticas: limpeza, roupas e sapatos
                                      "E033", # número de horas dedicas a afazeres dométicos
                                      "F007011", # recebimento de pensão, doação ou mesada 
                                      "F007021",# valor recebido de pensão, doação ou mesada
# PLANO DE SAÚDE
                                      "I00102", # tem algum plano de saude?
                                      "I006", # considera este plano de saúde
                                      "I00401", # o plano de saúde dá direito a consultas 
                                      "I00402", # o plano de saúde dá direito a exames
                                      "I00403", # o plano de saúde dá direito a internações
                                      "I00404", # o plano de saúde dá direito a partos
                                      "I012", # informante do módulo I
# UTILIZAÇÃO DE SERVIÇOS DE SAÚDE
                                      "J001", # como é o estado de saúde (avaliação)
                                      "J00101", # considerado saúde como um bem estar físico e mental (e não apenas doenças), como é o estado de saúde
                                      "J002", # na última semana, deixou de realizar alguma atividade por motivos de saúde
                                      "J00402", # qual foi o motivo de saúde que impediu
                                      "J01002", # quando está doente costuma procurar (UPA, consultório, etc)
                                      "J01101", # quando consultou o médico pela última vez
                                      "J014", # nas duas últimas semanas, procurou algum serviço de saúde
                                      "J01502", # qual o motivo principal pelo qual procurou atendimento relacionado a própria saúde
## QUESTIONÁRIO DO MORADOR SELECIONADO

                                      "P005", # a senhora está gravida no momento
# ATENDIMENTO PRÉ-NATAL
                                      "S065", # alguma vez ficou grávida, mesmo que a gravidez não tenha chegado até o final  
                                      "S066", # quantos partos a senhora já teve
                                      "S068", # quando estava grávida fez alguma consulta pré-natal
                                      "S06902", # quanto tempo em meses tinha quando fez a primeira consulta pré-natal
                                      "S070", # quantas consultas pré-natal fez durante esta gravidez 
                                      "S071", # fez a maioria das consultas do pré-natal em serviço de saúde de (UPA, UBS, etc)
                                      "S073", # as consultas foram feitas através do SUS?
                                      "S096", # quanto tempo antes do parto foi feita a última consulta do pré natal
                                      "S097", # foi informada para qual maternidade deveria se dirigir?
                                      "S114", # o parto foi feito através do sus
                                      "S115", # qual foi o tipo de parto
                                      "S11801", # quantidade de semanas que tinha no momento do parto (prematuridade)
                                      "S125", # teve alguma complicação durante o parto 
                                      "S126", # teve alguma complicação após o parto
                                      "S132", # o filho saiu do hospital junto com você
                                      "S133", # motivo do filho não ter saído junto do hospital
                                      "S134", # fez consulta de puerpério
# PATERNIDADE 
                                      'Z001', # você já teve/tem filhos biológicos
                                      "Z002", # quantos anos você tinha quando seu primeiro filho nasceu
                                      "Z004", # atualmente alguma mulher está grávida de você
                                      "Z005", # na gravidez atual ou na do seu último filho, você deseja ter filho naquele momento
                                      "Z008", # foi feito pré-natal na gravidez atual ou na do seu último filho
                                      "Z011", # Durante o pré-natal da gravidez atual ou da gravidez do último filho, você foi incentivado a participar de palestras, rodas de conversas, cursos, etc. sobre os cuidados com o bebê? 
                                      "Z012", # Você foi informado por algum profissional de saúde, que realizou o pré-natal, sobre a possibilidade de participar do momento do parto? 
# RENDIMENTO PÉR CAPTA 
                                      "VDF003", # rendimento domiciliar per capita(exclusive o rendimento das pessoas cuja a condição na unidade domiciliar era pensionista, empregado, doméstico etc)
                                      "VDF004"# faixa de rendimento domiciliar per capita(exclusive o rendimento das pessoas cuja a condição na unidade domiciliar era pensionista, empregado, doméstico etc)
                                      ), design = FALSE)
variaveis_desejadas_pns <- c(
  "V0001", "UPA_PNS", "V0006_PNS", "V0022", "V0026", "B001", "B003", "C004", "C006",
  "C008", "C009", "C01001", "C014", "C015", "C01801", "C00301",
  "D001", "D00901",
  "E001", "E005", "E006011", "E01602", "E017", "E03101", "E03102", "E033", "F007011", "F007021",
  "I00102", "I006", "I00401", "I00402", "I00403", "I00404", "I012",
  "J001", "J00101", "J002", "J00402", "J01002", "J01101", "J014", "J01502",
  "P005",
  "S065", "S066", "S068", "S06902", "S070", "S071", "S073", "S096", "S097", 
  "S114", "S115", "S11801", "S125", "S126", "S132", "S133", "S134",
  "Z001", "Z002", "Z004", "Z005", "Z008", "Z011", "Z012",
  "VDF003", "VDF004")

library(tidyverse)

pns_2019 <- pns_2019[, variaveis_desejadas_pns, drop = FALSE]

```


##  Identificação dos Domicílios de Interesse

```{r}
pns_2019 <- pns_2019 |> 
  mutate(domic_id = paste(pns_2019$UPA_PNS, pns_2019$V0006_PNS, sep = "-"))


pns_2019 <- pns_2019 |>
  mutate(pessoa_id = paste(pns_2019$domic_id, pns_2019$C00301, sep = "-")) |> 
  relocate(domic_id, pessoa_id)

library(dplyr)
pns_2019 |> 
  count(C004)

pns_2019 <- pns_2019 %>%
  mutate(tipo_mulher = case_when(
    C004 == "Cônjuge ou companheiro(a) de sexo diferente" & C006 == "Mulher" ~ "conjuge_mulher",
    C004 == "Pessoa responsável pelo domicílio" & C006 == "Mulher" ~ "responsavel_mulher",
    TRUE ~ NA_character_
  ))
pns_2019 |> 
  count(tipo_mulher)

domicilios_conjuge_mulher <- pns_2019 %>%
  filter(tipo_mulher == "conjuge_mulher") %>%
  pull(domic_id) %>%
  unique()

domicilios_responsavel_mulher <- pns_2019 %>%
  filter(tipo_mulher == "responsavel_mulher") %>%
  pull(domic_id) %>%
  unique()

filhos_por_domicilio <- pns_2019 %>%
  filter(C004 %in% c(
    "Filho(a) somente do cônjuge", 
    "Filho(a) somente do responsável", 
    "Filho(a) do responsável e do cônjuge"
  )) %>%
  mutate(tipo_filho = case_when(
    C004 == "Filho(a) somente do cônjuge" ~ "filho_do_conjuge",
    C004 == "Filho(a) somente do responsável" ~ "filho_do_responsavel",
    C004 == "Filho(a) do responsável e do cônjuge" ~ "filho_dos_dois"
  )) %>%
  group_by(domic_id) %>%
  summarise(
    filho_do_conjuge = any(tipo_filho == "filho_do_conjuge"),
    filho_do_responsavel = any(tipo_filho == "filho_do_responsavel"),
    filho_dos_dois = any(tipo_filho == "filho_dos_dois")
  )

domicilios_validos_conjuge <- filhos_por_domicilio %>%
  filter(filho_do_conjuge == TRUE) %>%
  filter(domic_id %in% domicilios_conjuge_mulher) %>%
  pull(domic_id)

domicilios_validos_responsavel <- filhos_por_domicilio %>%
  filter(filho_do_responsavel == TRUE) %>%
  filter(domic_id %in% domicilios_responsavel_mulher) %>%
  pull(domic_id)

domicilios_validos_final <- union(domicilios_validos_conjuge, domicilios_validos_responsavel)

pns_2019_filtrado <- pns_2019 %>%
  filter(domic_id %in% domicilios_validos_final)

pns_2019_filtrado |> 
  view()

```

##  Identificação dos Casos de Gravidez na Adolescência

```{r}
maes <- pns_2019_filtrado %>%
  filter(C004 %in% c("Pessoa responsável pelo domicílio", "Cônjuge ou companheiro(a) de sexo diferente"),
         C006 == "Mulher") %>%
  select(domic_id, idade_mae = C008)

filhos <- pns_2019_filtrado %>%
  filter(C004 %in% c("Filho(a) somente do responsável", "Filho(a) somente do cônjuge", "Filho(a) do responsável e do cônjuge")) %>%
  select(domic_id, idade_filho = C008)

maes_filhos <- left_join(filhos, maes, by = "domic_id")

maes_filhos <- maes_filhos %>%
  mutate(diferenca_idade = idade_mae - idade_filho)

tipo_gravidez_por_domicilio <- maes_filhos %>%
  group_by(domic_id) %>%
  summarise(
    gravidez_adolescencia = any(diferenca_idade < 18),
    .groups = "drop"
  ) %>%
  mutate(
    tipo_gravidez = ifelse(gravidez_adolescencia, "gravidez_adolescência", "gravidez_regular")
  ) %>%
  select(domic_id, tipo_gravidez)

pns_2019_filtrado <- pns_2019_filtrado |> 
  left_join(tipo_gravidez_por_domicilio, by = "domic_id")

pp_gravidez <- pns_2019_filtrado |> 
  count(tipo_gravidez) |> 
  mutate(pp = (n / sum(n))*100)
pp_gravidez |> 
  mutate(pp = round(pp, 2))
```
#  Análise Gráfica Inicial

##  Proporção Nacional

Nesta seção, apresentamos a proporção nacional de casos de gravidez na adolescência e gravidez regular identificados na amostra da PNS 2019, por meio de um gráfico de pizza.

```{r,, fig.width=7, fig.height=5}

pp_gravidez <- pp_gravidez %>%
  mutate(
    tipo_gravidez = case_when(
      tipo_gravidez == "gravidez_adolescência" ~ "Gravidez na Adolescência",
      tipo_gravidez == "gravidez_regular" ~ "Gravidez Regular",
      TRUE ~ tipo_gravidez
    ),
    pp = round(pp, 1)  
  )
ggplot(pp_gravidez, aes(x = "", y = pp, fill = tipo_gravidez)) +
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  scale_fill_manual(
    values = c("#e3120b", "#005082")  
  ) +
  labs(
    title = "Distribuição do Tipo de Gravidez\n(PNS 2019)",
    fill = "Tipo de Gravidez"
  ) +
  theme_minimal(base_family = "serif") +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    legend.title = element_text(face = "bold"),
    legend.text = element_text(face = "bold"),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  ) +
  geom_text(
    aes(label = paste0(pp, "%")),
    position = position_stack(vjust = 0.5),
    color = "white",
    fontface = "bold",   
    size = 5
  )
```

##  Proporção por Unidade Federativa

```{r, fig.width=7, fig.height=5}
dados_gravidez_uf <- pns_2019_filtrado %>%
  filter(!is.na(tipo_gravidez)) %>%
  group_by(V0001) %>% # V0001 é a UF na PNS
  summarise(
    gravidez_adolescencia = sum(tipo_gravidez == "gravidez_adolescência"),
    gravidez_total = n(),
    prop_gravidez_adolescencia = gravidez_adolescencia / gravidez_total
  )

dados_gravidez_uf <- dados_gravidez_uf |> 
  mutate(V0001 = case_when(
    V0001 == "Amazonas" ~ "Amazônas",
    V0001 == "Rio Grande do Norte" ~ "Rio Grande Do Norte",
    V0001 == "Rio de Janeiro" ~ "Rio De Janeiro",
    V0001 == "Rio Grande do Sul" ~ "Rio Grande Do Sul",
    V0001 == "Mato Grosso do Sul" ~ "Mato Grosso Do Sul",
    TRUE ~ V0001  # Mantém o resto como está
  ))

mapa_ufs <- read_state(code_state = "all", year = 2020)  # "all" pega todos os estados

mapa_gravidez <- mapa_ufs %>%
  left_join(dados_gravidez_uf, by = c("name_state" = "V0001"))

# Plotar o mapa
ggplot(mapa_gravidez) +
  geom_sf(aes(fill = prop_gravidez_adolescencia), color = "white") +
  scale_fill_gradient(
    low = "#e0f3f8", 
    high = "#08589e", 
    name = "Gravidez na Adolescência",
    labels = scales::percent_format(accuracy = 1)
  ) +
  theme_minimal() +
  labs(
    title = "Gravidez na Adolescência por UF",
    caption = "Fonte: PNS 2019 - IBGE"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    legend.title = element_text(face = "bold"),
    legend.text = element_text(face = "bold"),
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank()
  )
```

#  Relações que serão estudadas

As relações que serão estudadas são:

**Associação principal:** Idade materna (<18 vs ≥18 anos) e utilização dos serviços de saúde materno-infantil.

**Principais variáveis dependentes:** Início precoce do pré-natal; Número de consultas de pré-natal; Realização dos exames recomendados; Tipo de parto (cesáreo ou vaginal); Uso de serviços de saúde públicos (SUS) versus privados; Realização de consulta de puerpério.

**Princpais Variáveis de controle:** Escolaridade; Renda domiciliar per capita; Estado civil; Área de residência; Presença de plano de saúde; As análises considerarão o desenho amostral complexo da PNS 2019.

#  Referências

ANDERSEN, R. Revisiting the behavioral model and access to medical care: does it matter? Journal of Health and Social Behavior, v. 36, n. 1, p. 1–10, 1995.

ANDERSEN, R. M.; ADAY, L. A. Access to medical care in the United States: realized and potential. Medical Care, v. 16, n. 7, p. 533–546, 1978.

IBGE. Pesquisa Nacional de Saúde: 2019: percepção do estado de saúde, estilos de vida, doenças crônicas e saúde bucal. Rio de Janeiro: Instituto Brasileiro de Geografia e Estatística, 2020.

VIANELLO, L. D.; BUCHALLA, C. M. Desenvolvimento de um modelo de acesso aos serviços de saúde para mulheres adolescentes. Revista de Saúde Pública, v. 36, n. 5, p. 584–591, 2002.

WORLD HEALTH ORGANIZATION. Adolescent pregnancy. Geneva: WHO, 2018.


